{% extends 'base.html.twig' %}

{% block title %}{{ item.name }}{% endblock %}

{% block body %}
    <div id="show" class="container margin-navbar">
        <div class="show">
            {% include 'partials/_search.html.twig' %}
            <div class="item-header">
                <div class="item-header-left">
                    <div class="item-main-icon">
                        <img src="{{ asset('assets/images/uploads/api/' ~ item.entity.imageName) }}" alt="{{ item.name }}">
                    </div>
                    {% if children is defined and children is not empty %}
                        <div class="item-sub-icons">
                            {% for child in children %}
                                {% set childLabel = app.request.locale == 'fr'
                                    ? (child.nameFR ?? child.nameEN)
                                    : (child.nameEN ?? child.nameFR)
                                %}

                                {% set slug = child.uniqueName|trim('/')|replace({'/':'-'}) %}

                                <a href="{{ path('item_show', { name: slug }) }}" class="item-sub-icon" title="{{ childLabel }}">
                                    <img src="{{ asset('assets/images/uploads/api/' ~ child.imageName) }}" alt="{{ childLabel }}">
                                </a>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>

                <div class="item-header-right">
                    <div class="item-meta">
                        <h2 class="item-title">{{ item.name|upper }}</h2>
                        {% if item.description %}
                            <div class="item-meta-block">
                                <span class="item-meta-value">{{ item.description }}</i></span>
                            </div>
                        {% endif %}
                        {% if item.entity.ducats %}
                            <div class="item-meta-block">
                                <span class="item-meta-label">Ducats:</span>
                                <span class="item-meta-value">{{ item.entity.ducats }}</i></span>
                            </div>
                        {% endif %}
                        {% if item.entity.wikiaUrl %}
                            {% set url = item.entity.wikiaUrl|replace({' ': ''}) %}
                            <div class="item-meta-block btn-menu">
                                <a href="{{ url }}" target="_blank" rel="noopener noreferrer">
                                    <span class="item-meta-label">Wiki</span>
                                </a>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% if sellOrders is not empty or buyOrders is not empty %}
                <div class="orders-columns">
                    <div class="orders-column">
                        <h3 class="orders-title">{{ 'player-sell'|trans }}</h3>

                        {% if sellOrders is empty %}
                            <p class="empty-text">{{ 'no-sell'|trans }}</p>
                        {% else %}
                            <div class="orders-grid">
                                {% for order in sellOrders %}
                                    {% include 'partials/_order_card.html.twig' with { order: order } %}
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                    <div class="orders-column">
                        <h3 class="orders-title">{{ 'player-buy'|trans }}</h3>

                        {% if buyOrders is empty %}
                            <p class="empty-text">{{ 'no-buy'|trans }}</p>
                        {% else %}
                            <div class="orders-grid">
                                {% for order in buyOrders %}
                                    {% include 'partials/_order_card.html.twig' with { order: order } %}
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>

                </div>
            {% endif %}
        </div>
    </div>
{% endblock %}